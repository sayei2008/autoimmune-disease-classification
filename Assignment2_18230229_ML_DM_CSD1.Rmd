---
title: "Assignment 2-Data Mining and Machine Learning"
author: "Sai Krishna Lakshminarayanan (18230229)"
date: "2 November 2018"
output:
  word_document: default
---

Task -1

* In the first assignment, data has been taken and pre processing has been done along with 10 fold cross validation.

* Now, this data is taken and is split into two parts as train data and test data randomly in the parts of 2/3 and 1/3 respectively

* From the previous assignment, the packages of e1071 and RWeka are used again here to perform naive bayes classification and C4.5 respectively.

* The naive bayes classification model is generated by training the algorithm with the training data set values for Autoimmune Disease.

* It is then used to predict the values in test data which  is 1/3rd of the data set and a confusion matrix is obtained.

* The same process is repeatead for the C4.5 algorithm by generating a model with the training data set and using it to predict the values that are to be in the test dataset.

* Now,inorder to generate ROC curve, the ROCR package is used. ROCR is used to generate 2 dimensional ROC curves by combining two performance measures. It is highly flexible and usually has three commands with default values provided for the optional ones.

* For Naive bayes, the ROC curve is obtained by taking the predicted scores and storing it in a variable predicted score and taking the actual scores of the autoimmune disease in the test data set and storing it in a variable actual score.In the curve, the x axis is false positive rate and for y axis is true positive rate

* Now, performance measure of this parameter is done using performance() and stored which is then plotted to give the desired ROC plot.

* Using this, the Area of the Curve is also determined and its value is given.

* The same procedure is followed for the C 4.5 and the ROC curve and the area is obtained for it also by taking the predicted scores and acutal scores and checking the performance measure using them.

Task -2

```{r}
set.seed(108)
autoimmune <- read.delim("C:/Users/sayei/Downloads/autoimmune.txt",header = F)#importing the given data and giving Header as False so that age row values are not taken as column names
colnames(autoimmune)<-c(1:376)#providing column name to denote each patient from 1 to 376
rownames(autoimmune)<-c('Age','Blood_Pressure','BMI','Plasma_level','Autoimmune_disease','Adeverse_events','Drug_in_serum','Liver_function','Activity_test','Secondary_text')#providing the details as given in the assignment question
x<-as.data.frame(t(autoimmune))
x<-x[sample(nrow(x)),]#randomising the order of the row in the data x for better testing reasons 
folds <- cut(seq(1,nrow(x)),breaks=10,labels=FALSE)#Creating 10 fold command 
#Perform 10 fold cross validation
for(i in 1:10){#Segementing the data by fold using which() function
  testIndexes <- which(folds==i,arr.ind=TRUE)
  testData <- x[testIndexes, ]
  trainData <- x[-testIndexes, ]
}
data<-rbind(trainData,testData)
index<-sample.int(n=nrow(data),size = floor(0.70*length(data$Age)))
trainData<-data[index,]
testData<-data[-index,]

```

ROC Curve For Naive Bayes Algorithm
```{r}
library(e1071)#package for naive bayes algorithm
Naive_Bayes_Model1=naiveBayes(Autoimmune_disease~., data=trainData)# generating a training model for the algorithm
NB_Predictions1<-predict(Naive_Bayes_Model1,testData)#predicting the values for the test data
print(table(NB_Predictions1,testData$Autoimmune_disease))#giving out the confusion matrix for the test case
```

```{r}
library(ROCR)# package for generating ROC curves
NB_Predictions1<-predict(Naive_Bayes_Model1,testData,type = 'raw')#converting to suitable type
predicted_score <- NB_Predictions1[, "positive"]#taking the predicted value forpositive ones
actual_score <- testData$Autoimmune_disease#taking the actual values from the test data
pred <- prediction(predicted_score, actual_score) # predicting the measures
naive_bayes_performance = performance(pred, "tpr", "fpr") #taking the performance measure for naive bayes
plot(naive_bayes_performance, col = "red")# generating the required ROC curve
auc <- performance(pred,"auc") # obtaining the area value
print(auc@y.values[[1]]) #giving out the result

```
ROC Curve for C 4.5 Algorithm
```{r}
library(RWeka)#loading the package for performing C 4.5
C45 <- J48(Autoimmune_disease~., data=trainData) #training the model with the train data values 
predictions2 <- predict(C45, testData) #using it to predict the test data value
print(table(predictions2, testData$Autoimmune_disease))#giving out the final result
```

```{r}
a<- (predict(C45, testData,type='prob')) #converting it to a suitable type for execution
predicted_score1<-a[,"positive"] #obtaining the positive predicted values
actual_score1<-testData$Autoimmune_disease #obtaining the actual values in the test data
final<-prediction(predicted_score1,actual_score1)#checking the prediction that has been done by comparing the measures
C45_performance<-performance(final,"tpr","fpr")# evaluating the performance of the C 4.5 algorithm  
plot(C45_performance, col = "red")#plotting the required ROC curve
auc <- performance(final,"auc") # Generating the Area of the curve
print(auc@y.values[[1]])#Giving out the result
```

Task-3

*abcd

*abcd

*abcd


References

1.https://machinelearningmastery.com/non-linear-classification-in-r-with-decision-trees/
2.https://gist.github.com/duttashi/a51c71acb7388c535e30b57854598e77
3.https://cran.r-project.org/web/packages/RWeka/RWeka.pdf
4.https://hackerbits.com/data/c4-5-data-mining-algorithm/
5.http://blog.aylien.com/naive-bayes-for-dummies-a-simple-explanation/
6.https://stackoverflow.com/questions/30818188/roc-curve-in-r-using-rpart-package
7.http://information-gain.blogspot.com/
8.https://cran.r-project.org/web/packages/ROCR/ROCR.pdf
